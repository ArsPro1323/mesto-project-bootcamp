(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{_u:()=>T,vV:()=>g,oB:()=>O,Ml:()=>v});var t={baseUrl:"https://nomoreparties.co/v1/exp-mipt-fbc-1",headers:{authorization:"ef6c3b3d-d5f0-409c-a46a-757be69258e6","Content-Type":"application/json"}},n=function(e){return fetch("https://nomoreparties.co/v1/exp-mipt-fbc-1/cards/"+e,{method:"DELETE",headers:{authorization:"ef6c3b3d-d5f0-409c-a46a-757be69258e6","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))},o=function(e){return fetch("https://nomoreparties.co/v1/exp-mipt-fbc-1/cards/likes/"+e,{method:"PUT",headers:{authorization:"ef6c3b3d-d5f0-409c-a46a-757be69258e6","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))},r=function(e){return fetch("https://nomoreparties.co/v1/exp-mipt-fbc-1/cards/likes/"+e,{method:"DELETE",headers:{authorization:"ef6c3b3d-d5f0-409c-a46a-757be69258e6","Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))},c=function(e,t,n){u(t)?n.classList.add(e.inactiveButtonClass):n.classList.remove(e.inactiveButtonClass)},u=function(e){return e.some((function(e){return!e.validity.valid}))};function a(e){e.classList.add("popup_opened")}function i(e){e.classList.remove("popup_opened")}document.querySelector(".popup-edit__form");var d=document.querySelector("#card").content,s=document.querySelector(".popup-card__image"),l=document.querySelector(".popup-card__description");function p(e,t,n,o,r){var c=d.querySelector(".card").cloneNode(!0);c.id=r;var u=c.querySelector(".card__image");u.src=e,u.alt=t,u.addEventListener("click",f),c.querySelector(".card__like-number").textContent=n.length,c.querySelector(".card__name").textContent=t;for(var a=c.querySelector(".card__like-button"),i=0;i<n.length;++i)n[i]._id==v&&a.classList.add("card__like-button_on");a.addEventListener("click",_);var s=c.querySelector(".card__delete-button");return s.addEventListener("click",m),o!==v&&s.classList.add("card__delete-button-inactive"),c}function _(e){e.preventDefault();var t=e.currentTarget.closest(".card");e.currentTarget.classList.toggle("card__like-button_on");var n=e.currentTarget.closest(".card__like-section").querySelector(".card__like-number");String(e.currentTarget.classList).includes("card__like-button_on")?(n.textContent=Number(n.textContent)+1,o(t.id)):(n.textContent=Number(n.textContent)-1,r(t.id))}function f(e){e.preventDefault();var t=e.currentTarget.closest(".card");s.src=t.querySelector(".card__image").src,l.textContent=t.querySelector(".card__description").textContent,a(g)}function m(e){var t=e.currentTarget.closest(".card");n(t.id),t.remove()}var v,y=document.querySelector(".popup-edit"),h=document.querySelector(".popup-add-card"),S=document.querySelector(".popup-edit-logo"),b=document.querySelector(".popup-edit__save-button"),q=document.querySelector(".popup-add-card__save-button"),g=document.querySelector(".popup-card"),k=(S.querySelector(".popup-edit-logo__input"),document.querySelector(".popup-add-card__input_edit_name")),C=document.querySelector(".popup-add-card__input_edit_description"),L=document.querySelector(".popup-edit__input_edit_name"),E=document.querySelector(".popup-edit__input_edit_description"),j=document.querySelector(".profile__description"),x=document.querySelector(".profile__name"),T=document.querySelector(".elements"),P=document.querySelector(".popup-edit__input_edit_name"),A=document.querySelector(".popup-edit__input_edit_description"),U=document.querySelector(".popup-edit-logo__input"),z=document.querySelector(".profile__image"),B=document.querySelector(".popup-edit-logo__form"),D=document.querySelector(".popup-edit-logo__save-button");fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){v=e._id})).catch((function(e){console.log(e)}));var O=[],N={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"form__submit_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"};fetch("".concat(t.baseUrl,"/cards"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){for(var t=0;t<e.length;t++)O.push({name:e[t].name,link:e[t].link,likes:e[t].likes,owner:e[t].owner._id,id:e[t]._id});!function(){for(var e=0;e<O.length;e++)T.append(p(O[e].link,O[e].name,O[e].likes,O[e].owner,O[e].id))}()})).catch((function(e){console.log(e)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(t.querySelectorAll(e.inputSelector)),o=t.querySelector(e.submitButtonSelector);c(e,n,o),n.forEach((function(r){r.addEventListener("input",(function(){c(e,n,o),function(e,t,n){n.validity.valid?function(e,t,n){var o=t.querySelector(".".concat(n.id,"-error"));n.classList.remove(e.inputErrorClass),o.classList.remove(e.errorClass),o.textContent=""}(e,t,n):function(e,t,n,o){var r=t.querySelector(".".concat(n.id,"-error"));n.classList.add(e.inputErrorClass),r.textContent=o,r.classList.add(e.errorClass)}(e,t,n,n.validationMessage)}(e,t,r)}))}))}(e,t)}))}(N),fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){x.textContent=e.name,j.textContent=e.about,z.style.backgroundImage="url("+e.avatar+")"})).catch((function(e){console.log(e)})),document.querySelector(".popup-add-card__close-button").addEventListener("click",(function(){i(h)}));var w=Array.from(document.querySelector(".popup-add-card__form").querySelectorAll(N.inputSelector)),J=document.querySelector(".popup-add-card__form").querySelector(N.submitButtonSelector),H=Array.from(B.querySelectorAll(N.inputSelector));document.querySelector(".profile__add-button").addEventListener("click",(function(){k.value="",C.value="",c(N,w,J),q.textContent="Сохранить",a(h)})),document.querySelector(".popup-add-card__form").addEventListener("submit",(function(e){var n,o;e.preventDefault(),q.textContent="Сохранение...",(n=k.value,o=C.value,fetch("".concat(t.baseUrl,"/cards"),{method:"POST",headers:{authorization:"ef6c3b3d-d5f0-409c-a46a-757be69258e6","Content-Type":"application/json"},body:JSON.stringify({name:n,link:o})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){T.prepend(p(e.link,e.name,[],v,e._id))})).catch((function(e){console.log(e)})),i(h)})),document.querySelector(".popup-card__close-button").addEventListener("click",(function(){i(g)})),document.querySelector(".profile__edit-button").addEventListener("click",(function(){L.value=x.textContent,E.value=j.textContent,b.textContent="Сохранить",a(y)})),document.querySelector(".popup-edit__close-button").addEventListener("click",(function(){i(y)})),document.querySelector(".popup-edit__form").addEventListener("submit",(function(e){var n,o;e.preventDefault(),b.textContent="Сохранение...",(n=P.value,o=A.value,fetch("".concat(t.baseUrl,"/users/me"),{method:"PATCH",headers:{authorization:"ef6c3b3d-d5f0-409c-a46a-757be69258e6","Content-Type":"application/json"},body:JSON.stringify({name:n,about:o})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){x.textContent=e.name,j.textContent=e.about})).catch((function(e){console.log(e)})),y.classList.remove("popup_opened")})),B.addEventListener("submit",(function(e){var n;e.preventDefault(),D.textContent="Сохранение...",(n=U.value,fetch("".concat(t.baseUrl,"/users/me"),{method:"PATCH",headers:{authorization:"ef6c3b3d-d5f0-409c-a46a-757be69258e6","Content-Type":"application/json"},body:JSON.stringify({avatar:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){z.style.backgroundImage="url("+e.avatar+")"})).catch((function(e){console.log(e)})),i(S)})),h.addEventListener("click",(function(e){e.currentTarget===e.target&&i(h)})),y.addEventListener("click",(function(e){e.currentTarget===e.target&&i(y)})),g.addEventListener("click",(function(e){e.currentTarget===e.target&&i(g)})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&null!==document.querySelector(".popup_opened")&&i(document.querySelector(".popup_opened"))})),document.querySelector(".profile__change-logo-button").addEventListener("click",(function(){U.value="",c(N,H,D),D.textContent="Сохранить",a(S)})),document.querySelector(".popup-edit-logo__close-button").addEventListener("click",(function(){i(S)})),S.addEventListener("click",(function(e){e.currentTarget===e.target&&i(S)}))})();